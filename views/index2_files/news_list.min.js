$define(["wgt_util","js/pagination/initPagination","wgt_readyload","paging"],function($1,$,initPagination,r,page){var getInfoMessageNums=function(scope,appId,commentFormat){var idAttr=[];if(scope.find(".p_comment").each(function(a){var e=Number($(this).attr("infoId"));idAttr.push(e)}),0!=idAttr.length){var newsIds=idAttr.join(","),url="/message/ajax/nums",urlParam={appId:appId,id:newsIds,f:commentFormat},messageCountIcon='<i class="iconfont"></i>';$.ajax({type:"POST",url:url,data:urlParam,async:!1,success:function(data){var messageData=eval("("+data+")"),messageCountArray=messageData.data;null==messageData||"-1"==messageData.code?console.log(messageData.msg):null!=messageCountArray&&0<messageCountArray.length?($.each(messageCountArray,function(a,e){var t=messageCountArray[a].id,n=messageCountArray[a].format;scope.find(".p_comment[infoId="+t+"] .font").html(messageCountIcon+n)}),scope.find(".p_comment").each(function(a){""==$(this).text().trim()&&$(this).find(".font").html(messageCountIcon+0)})):scope.find(".p_comment .font").html(messageCountIcon+0)}})}},onNewsErrorImghandle=function(a,e,t){1==e||"true"==e?a.find(".js_thumb").onErrorImg(t):a.find(".js_thumb").onErrorImg()},imageHandle=function(a,e){var t=e.params.defaultNoPicture,n=e.params.isCheckedCustom;onNewsErrorImghandle(a,n,t);var i=2,s=e.params.isOpenCutMode,r=e.params.imageWidth,o=e.params.imageHeight;1!=s&&"true"!=s||(i=1),a.find(".p_images").css("width",r+"px"),a.find(".p_images").css("height",o+"px"),a.find(".p_images").putPhotoDiv(i)},coverUrlTitleHandle=function(a){a.find(".js_thumb").each(function(a,e){var t=$(this).parents(".p_articles").find(".js_coverUrlTitle").text().trim();$(this).attr("title",t),$(this).attr("alt",t)})},commentHandle=function(a,e){var t=e.params.commentFormat,n=e.params.appId,i=e.params.CommentBox;1!=i&&"true"!=i||getInfoMessageNums(a,n,t)},summaryHandle=function(a,e){1!=e.params.isAutoCutSummary&&"true"!=e.params.isAutoCutSummary||a.find(".p_summary").fixLineN(e.params.summaryMaxLen)},titleHandle=function(e,a){var t=a.params.titleIntercept,n=a.params.titleShowExtendLink;e.find(".p_header").each(function(a){e.find(".p_header").eq(a).newsAutoWidthBox("p_TitleBox")}),1!=t&&"true"!=t||(e.find(".p_title .font").fixLineN(n),e.find(".p_titleA .font").fixLineN(n))},paginationCallBack=function(a,e){$.ajax({url:a,type:"POST",beforeSend:function(a){},error:function(a,e,t){alert("数据加载错误 : "+t)},success:function(a){$("#"+e.params.divId).html(a)}})},turnPageTypeHandle=function(a,e){switch(e.params.turnPageType){case"rollingLoad":e.params.firstRefresh=!1,a.find(".p_news").paging(e.params);break;case"hidden":case"showMore":break;case"turnPage":initPagination._params=e,initPagination._params.params.callback=paginationCallBack,initPagination.init();break;case"marqueeLoad":case"scrollbar":a.find(".p_news").paging(e.params)}},init=function(){var a=this._params,e=$compCl.getScope(a.id);turnPageTypeHandle(e,a),imageHandle(e,a),commentHandle(e,a),titleHandle(e,a),summaryHandle(e,a),coverUrlTitleHandle(e),r.setCompPostion(),r.lazyImg({defObj:"#c_"+a.id})};return{init:init}});